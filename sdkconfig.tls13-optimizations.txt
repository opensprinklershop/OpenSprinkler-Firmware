# OpenSprinkler TLS 1.3 optimizations for ESP32-C5
# Add these to your sdkconfig.esp32-c5 or use via sdkconfig.defaults

# Enable TLS 1.3
CONFIG_MBEDTLS_SSL_PROTO_TLS1_3=y

# Disable TLS 1.2 and older
# CONFIG_MBEDTLS_SSL_PROTO_TLS1_2 is not set
# CONFIG_MBEDTLS_SSL_PROTO_DTLS is not set

# Disable ALL TLS 1.2 key exchange methods (not needed for TLS 1.3)
# CONFIG_MBEDTLS_KEY_EXCHANGE_PSK is not set
# CONFIG_MBEDTLS_KEY_EXCHANGE_DHE_PSK is not set
# CONFIG_MBEDTLS_KEY_EXCHANGE_ECDHE_PSK is not set
# CONFIG_MBEDTLS_KEY_EXCHANGE_RSA_PSK is not set
# CONFIG_MBEDTLS_KEY_EXCHANGE_RSA is not set
# CONFIG_MBEDTLS_KEY_EXCHANGE_DHE_RSA is not set
# CONFIG_MBEDTLS_KEY_EXCHANGE_ECDHE_RSA is not set
# CONFIG_MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA is not set
# CONFIG_MBEDTLS_KEY_EXCHANGE_ECDH_ECDSA is not set
# CONFIG_MBEDTLS_KEY_EXCHANGE_ECDH_RSA is not set
# CONFIG_MBEDTLS_KEY_EXCHANGE_ECJPAKE is not set

# Disable TLS 1.2-only features
# CONFIG_MBEDTLS_SSL_RENEGOTIATION is not set
# CONFIG_MBEDTLS_SSL_ENCRYPT_THEN_MAC is not set
# CONFIG_MBEDTLS_SSL_EXTENDED_MASTER_SECRET is not set

# Memory optimizations
CONFIG_MBEDTLS_SSL_MAX_CONTENT_LEN=4096
CONFIG_MBEDTLS_ASYMMETRIC_CONTENT_LEN=n

# Hardware acceleration (ESP32-C5)
CONFIG_MBEDTLS_HARDWARE_AES=y
CONFIG_MBEDTLS_HARDWARE_SHA=y
CONFIG_MBEDTLS_HARDWARE_ECC=y
CONFIG_MBEDTLS_HARDWARE_MPI=y

# AES interrupt-based acceleration
CONFIG_MBEDTLS_AES_USE_INTERRUPT=y
CONFIG_MBEDTLS_AES_INTERRUPT_LEVEL=0

# Enable only GCM mode (hardware-accelerated)
CONFIG_MBEDTLS_GCM_C=y

# Keep only necessary ECC curves for TLS 1.3
CONFIG_MBEDTLS_ECP_DP_SECP256R1_ENABLED=y
CONFIG_MBEDTLS_ECP_DP_SECP384R1_ENABLED=y

# Disable weak/unused curves
# CONFIG_MBEDTLS_ECP_DP_SECP192R1_ENABLED is not set
# CONFIG_MBEDTLS_ECP_DP_SECP224R1_ENABLED is not set
# CONFIG_MBEDTLS_ECP_DP_SECP521R1_ENABLED is not set
# CONFIG_MBEDTLS_ECP_DP_CURVE25519_ENABLED is not set

# Cryptographic algorithms for TLS 1.3
CONFIG_MBEDTLS_SHA256_C=y
CONFIG_MBEDTLS_SHA384_C=y
CONFIG_MBEDTLS_SHA512_C=y
CONFIG_MBEDTLS_ECP_C=y
CONFIG_MBEDTLS_ECDH_C=y
CONFIG_MBEDTLS_ECDSA_C=y

# Space savings - disable features not needed
# CONFIG_MBEDTLS_DEBUG is not set
# CONFIG_MBEDTLS_SSL_SESSION_TICKETS is not set
# CONFIG_MBEDTLS_CLIENT_SSL_SESSION_TICKETS is not set
# CONFIG_MBEDTLS_SERVER_SSL_SESSION_TICKETS is not set

# External memory allocation (already enabled)
CONFIG_MBEDTLS_EXTERNAL_MEM_ALLOC=y
